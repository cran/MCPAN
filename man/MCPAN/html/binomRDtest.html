<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Simultaneous test for contrasts of independent binomial proportions (in a oneway layout)</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for binomRDtest {MCPAN}"><tr><td>binomRDtest {MCPAN}</td><td align="right">R Documentation</td></tr></table>
<h2>Simultaneous test for contrasts of independent binomial proportions (in a oneway layout)</h2>


<h3>Description</h3>

<p>
P-value of maximum test and adjusted p-values for M contrasts of I groups
in a one-way layout. Tests are performed for contrasts of proportions,
which can be interpreted as differences of (weighted averages of) proportions.
</p>


<h3>Usage</h3>

<pre>
binomRDtest(x, ...)

## Default S3 method:
binomRDtest(x, n, names=NULL,
 type="Dunnett", cmat=NULL, method="Wald",
 alternative="two.sided",...)

## S3 method for class 'formula':
binomRDtest(formula, data,
 type="Dunnett", cmat=NULL, method="Wald",
 alternative="two.sided",...)

## S3 method for class 'table':
binomRDtest(x, type="Dunnett",
 cmat=NULL, method="Wald", alternative="two.sided",...)

## S3 method for class 'matrix':
binomRDtest(x, type="Dunnett",
 cmat=NULL, method="Wald", alternative="two.sided",...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
a numeric vector, giving the number of successes in I independent samples,
or an object of class <code>"table"</code>, representing the 2xk-table,
or an object of class <code>"matrix"</code>, representing the 2xk-table
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
a numerioc vector, giving the number of trials (i.e. the sample size) in each of the I groups </td></tr>
<tr valign="top"><td><code>names</code></td>
<td>
an optional character vector, giving the names of the groups in <code>x</code>, <code>n</code>; if not specified, possibly availbale names of x are taken as group names</td></tr>
<tr valign="top"><td><code>formula</code></td>
<td>
a two-sided formula of the style 'response ~ treatment', where 'response' should be a categorical variable with two levels,
while treatment should be a factor specifying the treatment levels</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
a data.frame, containing the variables specified in formula</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
a character string specifying the contrast type </td></tr>
<tr valign="top"><td><code>cmat</code></td>
<td>
an optional user defined contrast matrix of dimension MxI</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
a single charcter string, specifying the method for adjustment,
with options: "Wald" (Maximum likelihood estimators),
"ADD1" (add1-adjustment on the raw proportion estimates)
"ADD2" (add2-adjustment on proportion estimates following Agresti Caffo (2000))
</td></tr>
<tr valign="top"><td><code>alternative</code></td>
<td>
a character string specifying the direction of the alternative hypothesis</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
arguments to be passed to <code><a href="../../../doc/html/search/SearchObject.html?binomest">binomest</a></code>, currently only <code>success</code> labelling the event which should be considered as success</td></tr>
</table>

<h3>Details</h3>

<p>
For usage, see the examples.
</p>


<h3>Value</h3>

<p>
An object of class "binomRDtest", a list containing:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>teststat</code></td>
<td>
a numeric vector of teststatistics of length M</td></tr>
<tr valign="top"><td><code>pval</code></td>
<td>
a single numeric p-value, the p-value of the maximum test (minimum p-value)</td></tr>
<tr valign="top"><td><code>p.val.adj</code></td>
<td>
a vector of length M, the adjusted p-values of the single contrasts</td></tr>
<tr valign="top"><td><code>alternative</code></td>
<td>
a single character vector, as the input</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
the observed number of successes in the treatment groups</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
the number of trials in the treatment groups</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
the estimated proportions in the treatment groups</td></tr>
<tr valign="top"><td><code>success</code></td>
<td>
a character string labelling the event considered as success</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
as input, a character string</td></tr>
<tr valign="top"><td><code>cmat</code></td>
<td>
used contrast matrix</td></tr>
</table>

<h3>Note</h3>

<p>
Note, that all implemented methods are approximate only. The size of the 
test might seriously deviate from the nominal level for small sample sizes and extreme success probabilities.
See the simulation results in Sill (2007) for details.
</p>


<h3>Author(s)</h3>

<p>
Frank Schaarschmidt
</p>


<h3>References</h3>

<p>
Statistical procedures and characterization of coverage probabilities are described in:
Sill, M. (2007):
....
Master thesis, Institute of Biostatistics, Leibniz University Hannover.
</p>


<h3>See Also</h3>

<p>
<code><a href="../../../doc/html/search/SearchObject.html?summary.binomRDtest">summary.binomRDtest</a></code>
</p>


<h3>Examples</h3>

<pre>

ntrials &lt;- c(40,20,20,20)
xsuccesses &lt;- c(1,2,2,4)
names(xsuccesses) &lt;- LETTERS[1:4]
binomRDtest(x=xsuccesses, n=ntrials, method="ADD1", type="Dunnett")

binomRDtest(x=xsuccesses, n=ntrials, method="ADD1", type="Williams", alternative="greater")

binomRDtest(x=xsuccesses, n=ntrials, method="ADD2", type="Williams", alternative="greater")
</pre>



<hr><div align="center">[Package <em>MCPAN</em> <a href="00Index.html">Index]</a></div>

</body></html>
